var overlayGallery,overlayPromotion,fullscreenStatus=!1,viewData=[],countSlide=0,limitViewNumber=6,promotionShow=!1,paddingNumber=100,fullscreenElem=document.getElementById("carouselGalleryDetail"),players=[],slideData={curSlide:0,show:!1},YTdeferred=$.Deferred();window.onYouTubeIframeAPIReady=function(){YTdeferred.resolve(window.YT)},$(document).ready(function(){if($(".btn-thumbnail-view").click(function(){$("#mygallery").resetGallery().setThumbnailView({amountItem:6,marginItem:2}),$(this).addClass("active")}),$(".btn-justified-view").click(function(){$("#mygallery").resetGallery().setJustifiedView(),$(this).addClass("active")}),$(".btn-tile-view").click(function(){$("#mygallery").resetGallery().setTileView({amountItem:4,marginItem:2}),$(this).addClass("active")}),$("#mygallery").setJustifiedView(),overlayGallery=$(".overlay-gallery"),overlayPromotion=overlayGallery.find(".promotion"),overlayGallery.length){function o(e,l){var t;return"prev"==l?0==(t=e.prev()).length&&(t=e.siblings().last()):0==(t=e.next()).length&&(t=e.siblings().first()),t}function s(e){var l=e.find(".video-player").prop("id"),t=e.find(".video-player").data("videoid");if(void 0===l)return!1;if(void 0===players[l]){var i=new YT.Player(l,{height:"390",width:"640",videoId:t,playerVars:{showinfo:0,rel:0,modestbranding:0},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}});players[l]=i}}function c(e){var l=e.find(".video-player").prop("id");void 0!==players[l]&&players[l].stopVideo()}function d(e){var l=o(e,"prev"),t=o(e,"next");i(e),i(t),i(l)}function i(e){var l=e.find(".image-wrapper");if(0!=l.length){var t=$('<img alt="" />'),i=new Image;i.onload=function(){t.prop("src",this.src),imgHeight=t.prop("naturalHeight"),imgWidth=t.prop("naturalWidth"),ratioImg=imgWidth/imgHeight,ratioImg<viewData.ratioView?t.css({"max-height":viewData.viewHeight,"max-width":"auto"}):t.css({"max-width":"100%","max-height":"auto"})},i.src=l.data("imagesrc"),l.replaceWith(t)}}function e(){0==fullscreenStatus?(fullscreenStatus=!0,$(".btn-fullscreen").find("img.on").css("display","none"),$(".btn-fullscreen").find("img.off").css("display","block"),overlayPromotion.appendTo(".carousel"),overlayGallery.find(".overlay-content").setViewer2(screen.height,screen.width,0,!0)):(fullscreenStatus=!1,$(".btn-fullscreen").find("img.on").css("display","block"),$(".btn-fullscreen").find("img.off").css("display","none"),overlayPromotion.appendTo(overlayGallery.find(".overlay-content")),overlayGallery.find(".overlay-content").setViewer2($(window).height(),$(window).width(),paddingNumber,!0))}overlayGallery.find(".overlay-title").find("a").html(overlayGallery.find(".carousel .carousel-item").first().data("title")),overlayGallery.find(".carousel").hasClass("images")&&(overlayGallery.find(".overlay-title").find("a").html(overlayGallery.find(".carousel").data("title")),overlayGallery.find(".overlay-content > .right-content .description").html(overlayGallery.find(".carousel .carousel-item").first().data("title"))),overlayGallery.find(".overlay-content").setViewer2($(window).height(),$(window).width(),paddingNumber,!1),overlayGallery.find(".carousel").on("slid.bs.carousel",function(e){slideData.curSlide=e.to,countSlide==limitViewNumber&&(promotionShow=!0,countSlide=0)}),overlayGallery.find(".carousel .carousel-control-prev").click(function(){overlayGallery.find(".carousel").carousel("prev")}),overlayGallery.find(".carousel .carousel-control-next").click(function(){overlayGallery.find(".carousel").carousel("next")}),overlayGallery.find(".carousel").on("slide.bs.carousel",function(e){var l,t,i,r,a,n=$(e.relatedTarget);if(overlayGallery.find(".carousel").hasClass("video")?(a=o(r=n,"prev"),c(o(r,"next")),c(a),t=o(l=n,"next"),i=o(l,"prev"),s(l),s(t),s(i)):overlayGallery.find(".carousel").hasClass("images")&&d(n),1==promotionShow)return $(".overlay-title a").html(""),overlayPromotion.addClass("show"),promotionShow=!1;overlayGallery.find(".carousel").hasClass("images")?(overlayGallery.find(".overlay-title").find("a").html(overlayGallery.find(".carousel").data("title")),overlayGallery.find(".overlay-content > .right-content .description").html(n.data("title"))):$(".overlay-title a").html(n.data("title")),overlayPromotion.removeClass("show"),countSlide++}),overlayGallery.find("a.close-popup").click(function(){c($(".carousel.video .carousel-item.active")),countSlide=0,overlayGallery.css("display","none"),overlayPromotion.removeClass("show"),$("body").css("overflow","visible")}),overlayGallery.find(".promotion .btn-close").click(function(){countSlide=0,overlayPromotion.removeClass("show")}),$(".open-overlay").click(function(){$("body").css("overflow","hidden");var e=$(this).data("number");e==slideData.curSlide&&countSlide++,overlayGallery.fadeIn(),overlayGallery.find(".carousel").carousel(e)}),$(".btn-fullscreen").click(function(){0==fullscreenStatus?fullscreenElem.requestFullscreen?fullscreenElem.requestFullscreen():fullscreenElem.mozRequestFullScreen?fullscreenElem.mozRequestFullScreen():fullscreenElem.webkitRequestFullscreen?fullscreenElem.webkitRequestFullscreen():fullscreenElem.msRequestFullscreen&&fullscreenElem.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}),document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e)}($(".carousel-item .control-item").click(function(){return $(this).hasClass("control-prev")?(overlayGallery.find(".carousel").carousel("prev"),!1):$(this).hasClass("control-next")?(overlayGallery.find(".carousel").carousel("next"),!1):void 0}),0<overlayGallery.find(".carousel.images").length)&&d(overlayGallery.find(".carousel .carousel-item").first());function l(){var e=getCookie("slideData");return void 0!==e&&(getCookie("oldUrl")==window.location.href&&void((slideData=JSON.parse(e)).show&&($("body").css("overflow","hidden"),countSlide++,overlayGallery.fadeIn(),overlayGallery.find(".carousel").carousel(slideData.curSlide))))}0<overlayGallery.find(".carousel.video").length?YTdeferred.done(function(e){s(overlayGallery.find(".carousel .carousel-item").first()),l()}):l()}),$(document).keydown(function(e){if(void 0!==e&&overlayGallery.find(".carousel").is(":visible")){if(37===e.keyCode)return overlayGallery.find(".carousel").carousel("prev"),!1;if(39===e.keyCode)return overlayGallery.find(".carousel").carousel("next"),!1}}),$(window).resize(function(){0==fullscreenStatus&&overlayGallery.find(".overlay-content").setViewer2($(window).height(),$(window).width(),paddingNumber,!0)}),function(f){f.fn.setViewer2=function(e,l,t,i){var r=e-t,a=l-t,n=r,o=.7*a;1==fullscreenStatus&&(o=a);var s=o/n;if(viewData={ratioView:s,viewHeight:n,viewWidth:o},f(this).css({height:r,width:a,"margin-top":r/2*-1,"margin-left":a/2*-1,top:"50%",left:"50%"}),f(this).find(".promotion .left-content").css({width:o,height:n}),f(this).find(".promotion .right-content").css({width:a-o,height:n}),f(this).find(".left-content").css({width:o,height:n}),f(this).find(".carousel-item .content-center").css({width:o,height:n}),1==i)for(var c,d=f(this).find(".carousel-item img"),u=0;u<d.length;u++)c=d.eq(u).prop("naturalHeight"),d.eq(u).prop("naturalWidth")/c<s?d.eq(u).css({"max-height":n,"max-width":"auto"}):d.eq(u).css({"max-width":"100%","max-height":"auto"})},f.fn.setThumbnailView=function(e){var l=f.extend({amountItem:6,marginItem:2},l),t=f("main").width();$h=$w=t/l.amountItem-2*l.marginItem,f(this).addClass("thumbnail-view"),f(this).find(".item").css({height:$h,width:$w,margin:l.marginItem});for(var i,r=f(this).find("img"),a=0;a<r.length;a++)i=r.eq(a).prop("naturalHeight"),1<=r.eq(a).prop("naturalWidth")/i?r.eq(a).css({height:$h}):r.eq(a).css({width:$w})},f.fn.setTileView=function(e){var l=f.extend({amountItem:4,marginItem:2},l),t=f("main").width();$w=t/l.amountItem-2*l.marginItem,$h=195,f(this).addClass("tile-view"),f(this).find(".item").css({width:$w,margin:l.marginItem}),f(this).find(".item > a").css({height:$h});for(var i,r=f(this).find("img"),a=0;a<r.length;a++)i=r.eq(a).prop("naturalHeight"),1<=r.eq(a).prop("naturalWidth")/i?r.eq(a).css({width:"100%"}):r.eq(a).css({height:$h})},f.fn.setJustifiedView=function(){return f(this).justifiedGallery({rowHeight:195,margins:4,cssAnimation:!1,imagesAnimationDuration:0}),f(this)},f.fn.resetGallery=function(){return f(".gallery-toolbar .btn-view-control").removeClass("active"),f(this).justifiedGallery("destroy"),f(this).removeAttr("class style"),f(this).find(".item").removeAttr("class style").addClass("item"),f(this).find("a").removeAttr("style"),f(this).find("img").removeAttr("style"),f(this)}}(jQuery);var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];function onPlayerReady(e){e.target.setVolume(0)}function onPlayerStateChange(e){e.data==YT.PlayerState.ENDED&&setTimeout(function(){overlayGallery.find(".carousel").carousel("next")},1e3)}firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),$(window).on("unload",function(e){var l=overlayGallery.find(".carousel").is(":visible");slideData.show=l;var t=JSON.stringify(slideData);setCookie("oldUrl",window.location.href,0,60),setCookie("slideData",t,0,60)});