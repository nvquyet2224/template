<!DOCTYPE HTML>
<html lang="vi" class="useFull">

<head>
<meta charset="utf-8">
<title>Template</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">

<style type="text/css">
	body{
		margin:0;
		padding:0;
		width:100vw;
		height:100vh;
		overflow:hidden;
		cursor:pointer;
	}
	.main{
		background-color:#000;
		width:100%;
		height:100%;
	}
	
</style>
</head>

<body>

<div class="main">
<canvas id="canvas"></canvas>
</div>

<!--<script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js'></script>-->
<script src='js/TweenMax.min.js'></script>

<script>

	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	canvas.width = window.innerWidth;
	canvas.height = window.innerHeight;

	var circle = {
		x: 0,
		y: 0,
		radius:225
	}
	
	var dy = -(window.innerWidth * 0.5625 - window.innerHeight)/2;
	var moved = true;
	
	var imgBg = new Image();
	imgBg.src = "images/bg1.jpg";
	
	var imgMask = new Image();
	imgMask.src = "images/bg2.jpg";
	var first = true;
	var loaded = false;
	
	var size = Math.sqrt(screen.width * screen.width + screen.height * screen.height);
	var scale = size / circle.radius;

	imgBg.onload = function () {
		loaded = true;
	};
	
	function draw() {
		ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
		ctx.globalAlpha = 0.6;
		ctx.drawImage(imgBg,0,dy,window.innerWidth, window.innerWidth * 0.5625);
		ctx.save();
		ball();
	}
	
	function ball() {
		ctx.beginPath();
		ctx.globalAlpha = 1;
		ctx.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2, false);
		
		ctx.closePath();
		ctx.clip();
		
		ctx.drawImage(imgMask,0,dy,window.innerWidth, window.innerWidth * 0.5625);
		
		//imgMask.filters = [circle];
		//ctx.drawImage(imgMask,0,dy,window.innerWidth * scale, window.innerHeight * scale);
		
		ctx.restore();
	}
	
	TweenMax.ticker.addEventListener("tick", function(){
		if(loaded) {
			draw();
			if(first) {
				first = false;
				TweenMax.to(circle, 1.5, {x: window.innerWidth/2, y: window.innerHeight/2, onUpdate:draw});
			}
		}
	});

	function mousemove(e) {
	 	
		TweenMax.to(circle, 1.5, {x: e.pageX, y: e.pageY, onUpdate:draw});
		
		/*var tlm = new TimelineMax().add([ 
				TweenMax.to(circle, 1.5, {x: e.pageX, y: e.pageY, onUpdate:draw}),
				TweenMax.to(imgMask, 1.5, {scale:3, onUpdate:draw})
		]);*/
	}

	window.addEventListener("click", function(e) {
		if(moved){
			moved = false;
			TweenMax.to(circle, 1.5, {radius: window.innerWidth, onUpdate:draw});
		}else {
			moved = true;
			TweenMax.to(circle, 1.5, {radius: 225, onUpdate:draw});
		}
	});
	
	window.addEventListener('mousemove', mousemove);
	

</script>

</body>
</html>
